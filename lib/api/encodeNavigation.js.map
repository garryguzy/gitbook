{"version":3,"sources":["../../src/api/encodeNavigation.js"],"names":["Immutable","require","encodeArticle","pages","article","articlePath","getPath","path","title","getTitle","level","getLevel","exists","has","external","isExternal","encodeNavigation","output","book","getBook","getPages","summary","getSummary","articles","getArticlesAsList","navigation","map","i","ref","getRef","undefined","prev","get","next","index","introduction","filter","e","Boolean","Map","toJS","module","exports"],"mappings":";;AAAA,IAAMA,YAAYC,QAAQ,WAAR,CAAlB;;AAEA;;;;;;;AAOA,SAASC,aAAT,CAAuBC,KAAvB,EAA8BC,OAA9B,EAAuC;AACnC,QAAMC,cAAcD,QAAQE,OAAR,EAApB;;AAEA,WAAO;AACHC,cAAMF,WADH;AAEHG,eAAOJ,QAAQK,QAAR,EAFJ;AAGHC,eAAON,QAAQO,QAAR,EAHJ;AAIHC,gBAASP,eAAeF,MAAMU,GAAN,CAAUR,WAAV,CAJrB;AAKHS,kBAAUV,QAAQW,UAAR;AALP,KAAP;AAOH;;AAED;;;;;;AAMA,SAASC,gBAAT,CAA0BC,MAA1B,EAAkC;AAC9B,QAAMC,OAAOD,OAAOE,OAAP,EAAb;AACA,QAAMhB,QAAQc,OAAOG,QAAP,EAAd;AACA,QAAMC,UAAUH,KAAKI,UAAL,EAAhB;AACA,QAAMC,WAAWF,QAAQG,iBAAR,EAAjB;;AAGA,QAAMC,aAAaF,SACdG,GADc,CACV,UAACtB,OAAD,EAAUuB,CAAV,EAAgB;AACjB,YAAMC,MAAMxB,QAAQyB,MAAR,EAAZ;AACA,YAAI,CAACD,GAAL,EAAU;AACN,mBAAOE,SAAP;AACH;;AAED,YAAMC,OAAOR,SAASS,GAAT,CAAaL,IAAI,CAAjB,CAAb;AACA,YAAMM,OAAOV,SAASS,GAAT,CAAaL,IAAI,CAAjB,CAAb;;AAEA,eAAO,CACHC,GADG,EAEH;AACIM,mBAAOP,CADX;AAEInB,mBAAOJ,QAAQK,QAAR,EAFX;AAGI0B,0BAAeR,MAAM,CAHzB;AAIII,kBAAMA,OAAO7B,cAAcC,KAAd,EAAqB4B,IAArB,CAAP,GAAoCD,SAJ9C;AAKIG,kBAAMA,OAAO/B,cAAcC,KAAd,EAAqB8B,IAArB,CAAP,GAAoCH,SAL9C;AAMIpB,mBAAON,QAAQO,QAAR;AANX,SAFG,CAAP;AAWH,KArBc,EAsBdyB,MAtBc,CAsBP,UAACC,CAAD,EAAO;AACX,eAAOC,QAAQD,CAAR,CAAP;AACH,KAxBc,CAAnB;;AA0BA,WAAOrC,UAAUuC,GAAV,CAAcd,UAAd,EAA0Be,IAA1B,EAAP;AACH;;AAEDC,OAAOC,OAAP,GAAiB1B,gBAAjB","file":"encodeNavigation.js","sourcesContent":["const Immutable = require('immutable');\n\n/**\n * Encode an article for next/prev\n *\n * @param {Map<String:Page>}\n * @param {Article}\n * @return {Object}\n */\nfunction encodeArticle(pages, article) {\n    const articlePath = article.getPath();\n\n    return {\n        path: articlePath,\n        title: article.getTitle(),\n        level: article.getLevel(),\n        exists: (articlePath && pages.has(articlePath)),\n        external: article.isExternal()\n    };\n}\n\n/**\n * this.navigation is a deprecated property from GitBook v2\n *\n * @param {Output}\n * @return {Object}\n */\nfunction encodeNavigation(output) {\n    const book = output.getBook();\n    const pages = output.getPages();\n    const summary = book.getSummary();\n    const articles = summary.getArticlesAsList();\n\n\n    const navigation = articles\n        .map((article, i) => {\n            const ref = article.getRef();\n            if (!ref) {\n                return undefined;\n            }\n\n            const prev = articles.get(i - 1);\n            const next = articles.get(i + 1);\n\n            return [\n                ref,\n                {\n                    index: i,\n                    title: article.getTitle(),\n                    introduction: (i === 0),\n                    prev: prev ? encodeArticle(pages, prev) : undefined,\n                    next: next ? encodeArticle(pages, next) : undefined,\n                    level: article.getLevel()\n                }\n            ];\n        })\n        .filter((e) => {\n            return Boolean(e);\n        });\n\n    return Immutable.Map(navigation).toJS();\n}\n\nmodule.exports = encodeNavigation;\n"]}