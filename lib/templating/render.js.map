{"version":3,"sources":["../../src/templating/render.js"],"names":["Promise","require","timing","replaceShortcuts","renderTemplate","engine","filePath","content","context","blocks","env","toNunjucks","getBlocks","measure","nfcall","renderString","bind","path","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,kBAAR,CAAhB;AACA,IAAMC,SAASD,QAAQ,iBAAR,CAAf;AACA,IAAME,mBAAmBF,QAAQ,oBAAR,CAAzB;;AAEA;;;;;;;;;AASA,SAASG,cAAT,CAAwBC,MAAxB,EAAgCC,QAAhC,EAA0CC,OAA1C,EAAmDC,OAAnD,EAA4D;AACxDA,cAAUA,WAAW,EAArB;;AAEA;AACA,QAAMC,SAAS,EAAf;;AAEA;AACA,QAAMC,MAAML,OAAOM,UAAP,CAAkBF,MAAlB,CAAZ;;AAEA;AACAF,cAAUJ,iBAAiBE,OAAOO,SAAP,EAAjB,EAAqCN,QAArC,EAA+CC,OAA/C,CAAV;;AAEA,WAAOL,OAAOW,OAAP,CACH,iBADG,EAGHb,QAAQc,MAAR,CACIJ,IAAIK,YAAJ,CAAiBC,IAAjB,CAAsBN,GAAtB,CADJ,EAEIH,OAFJ,EAGIC,OAHJ,EAII;AACIS,cAAMX;AADV,KAJJ,CAHG,CAAP;AAYH;;AAEDY,OAAOC,OAAP,GAAiBf,cAAjB","file":"render.js","sourcesContent":["const Promise = require('../utils/promise');\nconst timing = require('../utils/timing');\nconst replaceShortcuts = require('./replaceShortcuts');\n\n/**\n * Render a template\n *\n * @param {TemplateEngine} engine\n * @param {String} filePath: absolute path for the loader\n * @param {String} content\n * @param {Object} context (optional)\n * @return {Promise<String>}\n */\nfunction renderTemplate(engine, filePath, content, context) {\n    context = context || {};\n\n    // Mutable objects to contains all blocks requiring post-processing\n    const blocks = {};\n\n    // Create nunjucks environment\n    const env = engine.toNunjucks(blocks);\n\n    // Replace shortcuts from plugin's blocks\n    content = replaceShortcuts(engine.getBlocks(), filePath, content);\n\n    return timing.measure(\n        'template.render',\n\n        Promise.nfcall(\n            env.renderString.bind(env),\n            content,\n            context,\n            {\n                path: filePath\n            }\n        )\n    );\n}\n\nmodule.exports = renderTemplate;\n"]}