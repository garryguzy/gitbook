{"version":3,"sources":["../../src/utils/reducedObject.js"],"names":["Immutable","require","reducedObject","defaultVersion","currentVersion","undefined","reduce","result","value","key","defaultValue","get","Map","isMap","diffs","size","set","is","module","exports"],"mappings":";;AAAA,IAAMA,YAAYC,QAAQ,WAAR,CAAlB;;AAEA;;;;;;AAMA,SAASC,aAAT,CAAuBC,cAAvB,EAAuCC,cAAvC,EAAuD;AACnD,QAAID,mBAAmBE,SAAvB,EAAkC;AAC9B,eAAOD,cAAP;AACH;;AAED,WAAOA,eAAeE,MAAf,CAAsB,UAACC,MAAD,EAASC,KAAT,EAAgBC,GAAhB,EAAwB;AACjD,YAAMC,eAAeP,eAAeQ,GAAf,CAAmBF,GAAnB,CAArB;;AAEA,YAAIT,UAAUY,GAAV,CAAcC,KAAd,CAAoBL,KAApB,CAAJ,EAAgC;AAC5B,gBAAMM,QAAQZ,cAAcQ,YAAd,EAA4BF,KAA5B,CAAd;;AAEA,gBAAIM,MAAMC,IAAN,GAAa,CAAjB,EAAoB;AAChB,uBAAOR,OAAOS,GAAP,CAAWP,GAAX,EAAgBK,KAAhB,CAAP;AACH;AACJ;;AAED,YAAId,UAAUiB,EAAV,CAAaP,YAAb,EAA2BF,KAA3B,CAAJ,EAAuC;AACnC,mBAAOD,MAAP;AACH;;AAED,eAAOA,OAAOS,GAAP,CAAWP,GAAX,EAAgBD,KAAhB,CAAP;AACH,KAhBM,EAgBJR,UAAUY,GAAV,EAhBI,CAAP;AAiBH;;AAEDM,OAAOC,OAAP,GAAiBjB,aAAjB","file":"reducedObject.js","sourcesContent":["const Immutable = require('immutable');\n\n/**\n *  Reduce the difference between a map and its default version\n *  @param {Map} defaultVersion\n *  @param {Map} currentVersion\n *  @return {Map} The properties of currentVersion that differs from defaultVersion\n */\nfunction reducedObject(defaultVersion, currentVersion) {\n    if (defaultVersion === undefined) {\n        return currentVersion;\n    }\n\n    return currentVersion.reduce((result, value, key) => {\n        const defaultValue = defaultVersion.get(key);\n\n        if (Immutable.Map.isMap(value)) {\n            const diffs = reducedObject(defaultValue, value);\n\n            if (diffs.size > 0) {\n                return result.set(key, diffs);\n            }\n        }\n\n        if (Immutable.is(defaultValue, value)) {\n            return result;\n        }\n\n        return result.set(key, value);\n    }, Immutable.Map());\n}\n\nmodule.exports = reducedObject;\n"]}