{"version":3,"sources":["../../src/parse/validateConfig.js"],"names":["jsonschema","require","jsonSchemaDefaults","schema","error","mergeDefaults","validateConfig","bookJson","v","Validator","result","validate","propertyName","errors","length","ConfigurationError","Error","stack","defaults","module","exports"],"mappings":";;AAAA,IAAMA,aAAaC,QAAQ,YAAR,CAAnB;AACA,IAAMC,qBAAqBD,QAAQ,sBAAR,CAA3B;;AAEA,IAAME,SAASF,QAAQ,2BAAR,CAAf;AACA,IAAMG,QAAQH,QAAQ,gBAAR,CAAd;AACA,IAAMI,gBAAgBJ,QAAQ,wBAAR,CAAtB;;AAEA;;;;;;;AAOA,SAASK,cAAT,CAAwBC,QAAxB,EAAkC;AAC9B,QAAMC,IAAI,IAAIR,WAAWS,SAAf,EAAV;AACA,QAAMC,SAASF,EAAEG,QAAF,CAAWJ,QAAX,EAAqBJ,MAArB,EAA6B;AACxCS,sBAAc;AAD0B,KAA7B,CAAf;;AAIA;AACA,QAAIF,OAAOG,MAAP,CAAcC,MAAd,GAAuB,CAA3B,EAA8B;AAC1B,cAAM,IAAIV,MAAMW,kBAAV,CAA6B,IAAIC,KAAJ,CAAUN,OAAOG,MAAP,CAAc,CAAd,EAAiBI,KAA3B,CAA7B,CAAN;AACH;;AAED;AACA,QAAMC,WAAWhB,mBAAmBC,MAAnB,CAAjB;AACA,WAAOE,cAAcE,QAAd,EAAwBW,QAAxB,CAAP;AACH;;AAEDC,OAAOC,OAAP,GAAiBd,cAAjB","file":"validateConfig.js","sourcesContent":["const jsonschema = require('jsonschema');\nconst jsonSchemaDefaults = require('json-schema-defaults');\n\nconst schema = require('../constants/configSchema');\nconst error = require('../utils/error');\nconst mergeDefaults = require('../utils/mergeDefaults');\n\n/**\n * Validate a book.json content\n * And return a mix with the default value\n *\n * @param {Object} bookJson\n * @return {Object}\n */\nfunction validateConfig(bookJson) {\n    const v = new jsonschema.Validator();\n    const result = v.validate(bookJson, schema, {\n        propertyName: 'config'\n    });\n\n    // Throw error\n    if (result.errors.length > 0) {\n        throw new error.ConfigurationError(new Error(result.errors[0].stack));\n    }\n\n    // Insert default values\n    const defaults = jsonSchemaDefaults(schema);\n    return mergeDefaults(bookJson, defaults);\n}\n\nmodule.exports = validateConfig;\n"]}