{"version":3,"sources":["../../src/plugins/validatePlugin.js"],"names":["gitbook","require","Promise","validatePlugin","plugin","packageInfos","getPackage","isValid","isLoaded","get","reject","Error","getName","getPath","engine","satisfies","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,YAAR,CAAhB;;AAEA,IAAMC,UAAUD,QAAQ,kBAAR,CAAhB;;AAEA;;;;;;AAMA,SAASE,cAAT,CAAwBC,MAAxB,EAAgC;AAC5B,QAAMC,eAAeD,OAAOE,UAAP,EAArB;;AAEA,QAAMC,UACFH,OAAOI,QAAP,MACAH,YADA,IAEAA,aAAaI,GAAb,CAAiB,MAAjB,CAFA,IAGAJ,aAAaI,GAAb,CAAiB,SAAjB,CAHA,IAIAJ,aAAaI,GAAb,CAAiB,SAAjB,EAA4BA,GAA5B,CAAgC,SAAhC,CALJ;;AAQA,QAAI,CAACF,OAAL,EAAc;AACV,eAAOL,QAAQQ,MAAR,CAAe,IAAIC,KAAJ,CAAU,2BAA2BP,OAAOQ,OAAP,EAA3B,GAA8C,QAA9C,GAAyDR,OAAOS,OAAP,EAAzD,GAA4E,GAAtF,CAAf,CAAP;AACH;;AAED,QAAMC,SAAST,aAAaI,GAAb,CAAiB,SAAjB,EAA4BA,GAA5B,CAAgC,SAAhC,CAAf;AACA,QAAI,CAACT,QAAQe,SAAR,CAAkBD,MAAlB,CAAL,EAAgC;AAC5B,eAAOZ,QAAQQ,MAAR,CAAe,IAAIC,KAAJ,CAAU,+DAA+DG,MAAzE,CAAf,CAAP;AACH;;AAED,WAAOZ,QAAQE,MAAR,CAAP;AACH;;AAEDY,OAAOC,OAAP,GAAiBd,cAAjB","file":"validatePlugin.js","sourcesContent":["const gitbook = require('../gitbook');\n\nconst Promise = require('../utils/promise');\n\n/**\n * Validate a plugin\n *\n * @param {Plugin}\n * @return {Promise<Plugin>}\n */\nfunction validatePlugin(plugin) {\n    const packageInfos = plugin.getPackage();\n\n    const isValid = (\n        plugin.isLoaded() &&\n        packageInfos &&\n        packageInfos.get('name') &&\n        packageInfos.get('engines') &&\n        packageInfos.get('engines').get('gitbook')\n    );\n\n    if (!isValid) {\n        return Promise.reject(new Error('Error loading plugin \"' + plugin.getName() + '\" at \"' + plugin.getPath() + '\"'));\n    }\n\n    const engine = packageInfos.get('engines').get('gitbook');\n    if (!gitbook.satisfies(engine)) {\n        return Promise.reject(new Error('GitBook doesn\\'t satisfy the requirements of this plugin: ' + engine));\n    }\n\n    return Promise(plugin);\n}\n\nmodule.exports = validatePlugin;\n"]}