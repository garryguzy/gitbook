{"version":3,"sources":["../../src/plugins/findForBook.js"],"names":["require","List","OrderedMap","Promise","timing","findInstalled","locateRootFolder","findForBook","book","measure","all","getRoot","then","results","reduce","out","result","merge","module","exports"],"mappings":";;eAA6BA,QAAQ,WAAR,C;IAArBC,I,YAAAA,I;IAAMC,U,YAAAA,U;;AAEd,IAAMC,UAAUH,QAAQ,kBAAR,CAAhB;AACA,IAAMI,SAASJ,QAAQ,iBAAR,CAAf;AACA,IAAMK,gBAAgBL,QAAQ,iBAAR,CAAtB;AACA,IAAMM,mBAAmBN,QAAQ,oBAAR,CAAzB;;AAEA;;;;;;AAMA,SAASO,WAAT,CAAqBC,IAArB,EAA2B;AACvB,WAAOJ,OAAOK,OAAP,CACH,qBADG,EAGHN,QAAQO,GAAR,CAAY,CACRL,cAAcC,kBAAd,CADQ,EAERD,cAAcG,KAAKG,OAAL,EAAd,CAFQ,CAAZ;;AAKA;AALA,KAMCC,IAND,CAMM,UAACC,OAAD,EAAa;AACf,eAAOZ,KAAKY,OAAL,EACFC,MADE,CACK,UAACC,GAAD,EAAMC,MAAN,EAAiB;AACrB,mBAAOD,IAAIE,KAAJ,CAAUD,MAAV,CAAP;AACH,SAHE,EAGAd,YAHA,CAAP;AAIH,KAXD,CAHG,CAAP;AAgBH;;AAEDgB,OAAOC,OAAP,GAAiBZ,WAAjB","file":"findForBook.js","sourcesContent":["const { List, OrderedMap } = require('immutable');\n\nconst Promise = require('../utils/promise');\nconst timing = require('../utils/timing');\nconst findInstalled = require('./findInstalled');\nconst locateRootFolder = require('./locateRootFolder');\n\n/**\n * List all plugins installed in a book\n *\n * @param {Book}\n * @return {Promise<OrderedMap<String:Plugin>>}\n */\nfunction findForBook(book) {\n    return timing.measure(\n        'plugins.findForBook',\n\n        Promise.all([\n            findInstalled(locateRootFolder()),\n            findInstalled(book.getRoot())\n        ])\n\n        // Merge all plugins\n        .then((results) => {\n            return List(results)\n                .reduce((out, result) => {\n                    return out.merge(result);\n                }, OrderedMap());\n        })\n    );\n}\n\nmodule.exports = findForBook;\n"]}