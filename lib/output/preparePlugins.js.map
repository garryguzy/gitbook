{"version":3,"sources":["../../src/output/preparePlugins.js"],"names":["Plugins","require","Promise","preparePlugins","output","book","getBook","then","isLanguageBook","getPlugins","loadForBook","plugins","validateConfig","newBook","merge","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,YAAR,CAAhB;AACA,IAAMC,UAAUD,QAAQ,kBAAR,CAAhB;;AAEA;;;;;;AAMA,SAASE,cAAT,CAAwBC,MAAxB,EAAgC;AAC5B,QAAMC,OAAOD,OAAOE,OAAP,EAAb;;AAEA,WAAOJ;;AAEP;AAFO,KAGNK,IAHM,CAGD,YAAM;AACR,YAAIF,KAAKG,cAAL,EAAJ,EAA2B;AACvB,mBAAOJ,OAAOK,UAAP,EAAP;AACH,SAFD,MAEO;AACH,mBAAOT,QAAQU,WAAR,CAAoBL,IAApB,CAAP;AACH;AACJ,KATM;;AAWP;AAXO,KAYNE,IAZM,CAYD,UAACI,OAAD,EAAa;AACf,eAAOX,QAAQY,cAAR,CAAuBP,IAAvB,EAA6BM,OAA7B,EACNJ,IADM,CACD,UAACM,OAAD,EAAa;AACf,mBAAOT,OAAOU,KAAP,CAAa;AAChBT,sBAAMQ,OADU;AAEhBF;AAFgB,aAAb,CAAP;AAIH,SANM,CAAP;AAOH,KApBM,CAAP;AAqBH;;AAEDI,OAAOC,OAAP,GAAiBb,cAAjB","file":"preparePlugins.js","sourcesContent":["const Plugins = require('../plugins');\nconst Promise = require('../utils/promise');\n\n/**\n * Load and setup plugins\n *\n * @param {Output}\n * @return {Promise<Output>}\n */\nfunction preparePlugins(output) {\n    const book = output.getBook();\n\n    return Promise()\n\n    // Only load plugins for main book\n    .then(() => {\n        if (book.isLanguageBook()) {\n            return output.getPlugins();\n        } else {\n            return Plugins.loadForBook(book);\n        }\n    })\n\n    // Update book's configuration using the plugins\n    .then((plugins) => {\n        return Plugins.validateConfig(book, plugins)\n        .then((newBook) => {\n            return output.merge({\n                book: newBook,\n                plugins\n            });\n        });\n    });\n}\n\nmodule.exports = preparePlugins;\n"]}