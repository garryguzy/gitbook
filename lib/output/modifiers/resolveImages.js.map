{"version":3,"sources":["../../../src/output/modifiers/resolveImages.js"],"names":["path","require","LocationUtils","editHTMLElement","resolveImages","currentFile","$","currentDirectory","dirname","$img","src","attr","isExternal","isDataURI","toAbsolute","relative","module","exports"],"mappings":";;AAAA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;;AAEA,IAAMC,gBAAgBD,QAAQ,sBAAR,CAAtB;AACA,IAAME,kBAAkBF,QAAQ,mBAAR,CAAxB;;AAEA;;;;;;;AAOA,SAASG,aAAT,CAAuBC,WAAvB,EAAoCC,CAApC,EAAuC;AACnC,QAAMC,mBAAmBP,KAAKQ,OAAL,CAAaH,WAAb,CAAzB;;AAEA,WAAOF,gBAAgBG,CAAhB,EAAmB,KAAnB,EAA0B,UAACG,IAAD,EAAU;AACvC,YAAIC,MAAMD,KAAKE,IAAL,CAAU,KAAV,CAAV;;AAEA,YAAIT,cAAcU,UAAd,CAAyBF,GAAzB,KAAiCR,cAAcW,SAAd,CAAwBH,GAAxB,CAArC,EAAmE;AAC/D;AACH;;AAED;AACAA,cAAMR,cAAcY,UAAd,CAAyBJ,GAAzB,EAA8BH,gBAA9B,EAAgD,GAAhD,CAAN;;AAEA;AACAG,cAAMR,cAAca,QAAd,CAAuBR,gBAAvB,EAAyCG,GAAzC,CAAN;;AAEAD,aAAKE,IAAL,CAAU,KAAV,EAAiBD,GAAjB;AACH,KAdM,CAAP;AAeH;;AAEDM,OAAOC,OAAP,GAAiBb,aAAjB","file":"resolveImages.js","sourcesContent":["const path = require('path');\n\nconst LocationUtils = require('../../utils/location');\nconst editHTMLElement = require('./editHTMLElement');\n\n/**\n * Resolve all HTML images:\n * - /test.png in hello -> ../test.html\n *\n * @param {String} currentFile\n * @param {HTMLDom} $\n */\nfunction resolveImages(currentFile, $) {\n    const currentDirectory = path.dirname(currentFile);\n\n    return editHTMLElement($, 'img', ($img) => {\n        let src = $img.attr('src');\n\n        if (LocationUtils.isExternal(src) || LocationUtils.isDataURI(src)) {\n            return;\n        }\n\n        // Calcul absolute path for this\n        src = LocationUtils.toAbsolute(src, currentDirectory, '.');\n\n        // Convert back to relative\n        src = LocationUtils.relative(currentDirectory, src);\n\n        $img.attr('src', src);\n    });\n}\n\nmodule.exports = resolveImages;\n"]}